/**
 * djax - A lightweight jQuery.ajax subset
 * @version v1.0.2
 * @link https://github.com/jacomyal/djax
 * @license MIT
 */
(function(t){"use strict";function e(n,r){if(!e.xhr)throw new Error("XMLHttpRequest not found. You can specify which XMLHttpRequest you want to use by using `ajax.xhr = myXHR`.");var o=[],s=[];if("string"==typeof n)n={url:n},2===arguments.length&&("function"==typeof r?o.push(r):Array.isArray(r)&&(o=o.concat(r)));else if("object"!=typeof n||!n)throw new Error("Wrong arguments");"function"==typeof n.success?o.push(n.success):Array.isArray(n.success)&&(o=o.concat(n.success)),"function"==typeof n.error?s.push(n.error):Array.isArray(n.error)&&(s=s.concat(n.error));var i,u,a,f,c,y=!1,p=n.url,d=new e.xhr,h=n.type||"GET",l=n.dataType||"json",m=n.contentType||"application/x-www-form-urlencoded";if(!p||"string"!=typeof p)throw new Error("Wrong arguments");if(n.data){if("string"==typeof n.data)u=n.data;else if(/json/.test(m))u=JSON.stringify(n.data);else{u=[];for(i in n.data)u.push(encodeURIComponent(i)+"="+encodeURIComponent(n.data[i]));u=u.join("&")}/GET|DELETE/i.test(h)&&(p+=/\?/.test(p)?"&"+u:"?"+u,u="")}if(d.onreadystatechange=function(){if(4===+d.readyState)if(y=!0,a&&clearTimeout(a),/^2/.test(d.status)){if(y=!0,c="success",u=d.responseText,/json/.test(l))try{u=u?JSON.parse(u):""}catch(e){return f=function(t,e){e.forEach(function(t){t(d,c="parsererror")})},void f(null,s)}204===+d.status&&(c="nocontent",u=t),f=function(t,e){t.forEach(function(t){t(u,c,d)})},f(o)}else(f=function(t,e){e.forEach(function(t){t(d,+d.status?"error":"abort",d.responseText)})})(null,s)},d.open(h,p,!0),d.setRequestHeader("Content-Type",m),n.headers)for(i in n.headers)d.setRequestHeader(i,n.headers[i]);return"function"==typeof n.beforeSend&&n.beforeSend(d,n)===!1?(y=!0,f=function(t,e){e.forEach(function(t){t(d,"abort",d.responseText)})},f(null,s),d.abort()):(n.timeout&&(a=setTimeout(function(){y=!0,d.onreadystatechange=function(){},d.abort(),(f=function(t,e){e.forEach(function(t){t(d,"timeout")})})(null,s)},n.timeout)),d.send(u),d.done=function(t){if("function"==typeof t)o.push(t);else{if(!Array.isArray(t))throw new Error("Wrong arguments.");o=o.concat(t)}return y&&("function"==typeof t?f([t]):Array.isArray(t)&&f(t)),this},d.fail=function(t){if("function"==typeof t)s.push(t);else{if(!Array.isArray(t))throw new Error("Wrong arguments.");s=s.concat(t)}return y&&("function"==typeof t?f(null,[t]):Array.isArray(t)&&f(null,t)),this},d.then=function(t,e){return t&&this.done(t),e&&this.fail(e),y&&f(Array.isArray(t)?t:"function"==typeof t?[t]:null,Array.isArray(e)?e:"function"==typeof e?[e]:null),this},d)}e.version="1.0.2","undefined"!=typeof XMLHttpRequest&&(e.xhr=XMLHttpRequest),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.ajax=e):"function"==typeof define&&define.amd?define("djax",[],function(){return e}):this.ajax=e}).call(this);